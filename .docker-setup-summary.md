# Docker Setup Summary

## What Was Created

### 1. Core Docker Files

#### `Dockerfile`
- Uses Python 3.12 slim base image
- Installs `uv` from official source
- Copies only `pyproject.toml` and `uv.lock` for dependency installation
- Source code is mounted at runtime (no rebuild needed for code changes)
- Creates logs directory

#### `docker-compose.yml`
- Defines `agentic-framework` service
- **Volume Mounts:**
  - `./agentic-framework/src` → `/app/agentic-framework/src` (read-only)
  - `./agentic-framework/tests` → `/app/agentic-framework/tests` (read-only)
  - `./agentic-framework/logs` → `/app/agentic-framework/logs` (read-write)
  - `./agentic-framework/pyproject.toml` → `/app/agentic-framework/pyproject.toml` (read-only)
  - `./agentic-framework/uv.lock` → `/app/agentic-framework/uv.lock` (read-only)
- **Environment:** Loads from `.env` file
- **Command:** Default shows help

#### `.dockerignore`
- Excludes unnecessary files from build context
- Reduces image size and build time
- Ignores: cache dirs, virtual envs, git files, etc.

### 2. Makefile Targets

Added 10 new Docker targets:

| Target | Purpose |
|--------|---------|
| `docker-build` | Build the Docker image |
| `docker-run` | Run any agentic-run command |
| `docker-chef` | Shortcut for chef agent |
| `docker-test` | Run tests in container |
| `docker-lint` | Run linting in container |
| `docker-shell` | Interactive bash shell |
| `docker-logs` | View container logs |
| `docker-start` | Start in detached mode |
| `docker-stop` | Stop the container |
| `docker-clean` | Remove containers/images |

### 3. Documentation

#### `DOCKER.md` (Comprehensive Guide)
- Features overview
- Quick start guide
- All Make targets explained
- Volume mount details
- Environment variable handling
- When to rebuild
- Advanced usage examples
- Troubleshooting section
- Best practices

#### `.docker-quick-ref.md` (Quick Reference)
- Essential commands
- Rebuild guidelines
- File location mapping
- Common troubleshooting

#### Updated `README.md`
- Added Docker Support section
- Updated Development Commands
- Links to DOCKER.md

## How It Works

### Live Code Updates (No Rebuild)

```
Host Machine                    Docker Container
─────────────                   ────────────────
agentic-framework/src/   ←──→   /app/agentic-framework/src/
    (you edit here)             (container reads from here)
```

When you edit Python files in `src/` or `tests/`, changes are immediately available in the container because these directories are mounted as volumes.

### Environment Variables

```
Host Machine                    Docker Container
─────────────                   ────────────────
.env file                ──→    Environment Variables
(OPENAI_API_KEY=...)            (OPENAI_API_KEY=...)
```

The `.env` file is read by Docker Compose and passed as environment variables to the container. This keeps secrets out of the image.

### Logs

```
Host Machine                    Docker Container
─────────────                   ────────────────
agentic-framework/logs/  ←──→   /app/agentic-framework/logs/
agent.log                       agent.log
```

Logs are written to a mounted volume, so you can access them from both the host and container.

## Usage Examples

### Basic Usage

```bash
# First time setup
make docker-build

# Run an agent
make docker-chef INPUT="I have bread, tuna, lettuce and mayo"

# View logs
tail -f agentic-framework/logs/agent.log
```

### Development Workflow

```bash
# 1. Build image (once)
make docker-build

# 2. Edit code in src/
vim agentic-framework/src/agentic_framework/core/chef_agent.py

# 3. Run immediately (no rebuild!)
make docker-chef INPUT="test input"

# 4. Check logs
cat agentic-framework/logs/agent.log
```

### Testing Workflow

```bash
# Run tests
make docker-test

# Run linting
make docker-lint

# Debug in shell
make docker-shell
# Inside container:
uv --directory agentic-framework run pytest -v
```

## Key Benefits

✅ **No Rebuild for Code Changes**
- Edit Python files freely
- Changes reflected immediately
- Fast iteration cycle

✅ **Safe Environment Variables**
- Secrets in `.env` file
- Not embedded in image
- Easy to update

✅ **Accessible Logs**
- Same location as local development
- No need to `docker exec` to view
- Can use standard tools (tail, grep, etc.)

✅ **Consistent with Local Development**
- Uses `uv` just like local
- Same commands, same behavior
- Easy to switch between local and Docker

## When to Use Docker vs Local

### Use Docker When:
- Setting up on a new machine
- Want isolated environment
- Testing deployment configuration
- Sharing with team members
- CI/CD pipeline

### Use Local When:
- Active development with IDE
- Debugging with breakpoints
- Faster startup time
- Direct access to Python REPL

## Next Steps

1. **Build the image:**
   ```bash
   make docker-build
   ```

2. **Test it works:**
   ```bash
   make docker-run CMD="list"
   ```

3. **Run an agent:**
   ```bash
   make docker-chef INPUT="I have eggs and cheese"
   ```

4. **Check logs:**
   ```bash
   cat agentic-framework/logs/agent.log
   ```

5. **Read full docs:**
   ```bash
   cat DOCKER.md
   ```

## Troubleshooting

If you encounter issues:

1. **Check Docker is running:**
   ```bash
   docker ps
   ```

2. **Verify configuration:**
   ```bash
   docker compose config
   ```

3. **Check .env file:**
   ```bash
   cat .env
   ```

4. **View detailed logs:**
   ```bash
   make docker-logs
   ```

5. **Clean and rebuild:**
   ```bash
   make docker-clean
   make docker-build
   ```

## Files Created

```
/Users/jeancsil/code/agents/
├── Dockerfile                    # Docker image definition
├── docker-compose.yml            # Service configuration
├── .dockerignore                 # Build context exclusions
├── DOCKER.md                     # Comprehensive documentation
├── .docker-quick-ref.md          # Quick reference
├── Makefile                      # Updated with Docker targets
└── README.md                     # Updated with Docker section
```
