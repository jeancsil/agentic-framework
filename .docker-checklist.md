# Docker Setup Checklist

Use this checklist to get your Dockerized application running.

## Pre-flight Checks

- [ ] Docker is installed and running
  ```bash
  docker --version
  docker compose version
  ```

- [ ] `.env` file exists with your API keys
  ```bash
  ls -la .env
  cat .env  # Verify keys are present
  ```

- [ ] Logs directory exists
  ```bash
  ls -la agentic-framework/logs/
  ```

## First-Time Setup

- [ ] Build the Docker image
  ```bash
  make docker-build
  ```
  Expected: Build completes without errors

- [ ] Verify image was created
  ```bash
  docker images | grep agents
  ```
  Expected: See `agents-agentic-framework` image

- [ ] Test with list command
  ```bash
  make docker-run CMD="list"
  ```
  Expected: See list of available agents

## Verify Volume Mounts

- [ ] Check source code is mounted
  ```bash
  docker compose config | grep -A 5 "source.*src"
  ```
  Expected: See `./agentic-framework/src` mounted

- [ ] Check logs are mounted
  ```bash
  docker compose config | grep -A 5 "source.*logs"
  ```
  Expected: See `./agentic-framework/logs` mounted

## Verify Environment Variables

- [ ] Check .env is loaded
  ```bash
  docker compose config | grep -A 10 environment
  ```
  Expected: See your API keys listed

## Test Live Code Updates

- [ ] Make a small change to a Python file
  ```bash
  # Add a comment or print statement to:
  vim agentic-framework/src/agentic_framework/cli.py
  ```

- [ ] Run without rebuilding
  ```bash
  make docker-run CMD="list"
  ```
  Expected: Command runs successfully (no rebuild needed)

## Test Logging

- [ ] Run an agent
  ```bash
  make docker-chef INPUT="I have eggs and cheese"
  ```

- [ ] Check logs were created
  ```bash
  ls -la agentic-framework/logs/agent.log
  ```
  Expected: Log file exists

- [ ] View logs from host
  ```bash
  tail -20 agentic-framework/logs/agent.log
  ```
  Expected: See recent log entries

## Test All Make Targets

- [ ] `make docker-build` - Builds successfully
- [ ] `make docker-run CMD="list"` - Lists agents
- [ ] `make docker-chef INPUT="test"` - Runs chef agent
- [ ] `make docker-test` - Runs tests (may take a minute)
- [ ] `make docker-shell` - Opens interactive shell (type `exit` to leave)
- [ ] `make docker-logs` - Shows logs (Ctrl+C to exit)
- [ ] `make docker-start` - Starts in background
- [ ] `make docker-stop` - Stops container
- [ ] `make docker-clean` - Cleans up

## Common Issues

### Issue: "Cannot connect to Docker daemon"
**Solution:**
```bash
# Start Docker Desktop or Docker service
open -a Docker  # macOS
```

### Issue: "No such file or directory: .env"
**Solution:**
```bash
# Copy example and add your keys
cp .env.example .env
vim .env
```

### Issue: "Permission denied" on logs
**Solution:**
```bash
chmod -R 755 agentic-framework/logs
```

### Issue: "Port already in use"
**Solution:**
```bash
# Stop existing containers
make docker-stop
docker ps -a  # Check for other containers
```

### Issue: Build fails with dependency errors
**Solution:**
```bash
# Clean and rebuild
make docker-clean
make docker-build
```

## Success Criteria

You've successfully set up Docker when:

✅ `make docker-build` completes without errors
✅ `make docker-run CMD="list"` shows available agents
✅ `make docker-chef INPUT="test"` runs and produces output
✅ Logs appear in `agentic-framework/logs/agent.log`
✅ Editing Python files doesn't require rebuild
✅ Environment variables from `.env` are loaded

## Next Steps

Once everything is working:

1. **Read the full documentation:**
   ```bash
   cat DOCKER.md
   ```

2. **Try different agents:**
   ```bash
   make docker-run CMD="simple -i 'Hello world'"
   make docker-run CMD="travel -i 'Plan a trip to Paris'"
   ```

3. **Develop with live updates:**
   - Edit code in `agentic-framework/src/`
   - Run immediately with `make docker-chef INPUT="..."`
   - No rebuild needed!

4. **Monitor logs:**
   ```bash
   tail -f agentic-framework/logs/agent.log
   ```

## Quick Reference

```bash
# Build (first time or after dependency changes)
make docker-build

# Run agents
make docker-chef INPUT="your ingredients"
make docker-run CMD="agent-name -i 'input'"

# Development
make docker-test     # Run tests
make docker-lint     # Run linting
make docker-shell    # Interactive shell

# Logs
tail -f agentic-framework/logs/agent.log

# Cleanup
make docker-stop     # Stop container
make docker-clean    # Remove everything
```

---

**Need Help?**
- See `DOCKER.md` for comprehensive documentation
- See `.docker-quick-ref.md` for command reference
- Run `make help` to see all available commands
